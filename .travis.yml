language: python
python:
- '3.6'
sudo: required
services:
- docker
env:
  global:
  - REGISTRY_USER=ocadotechnologygitlab
  - VCS_SOURCE="https://github.com/${TRAVIS_REPO_SLUG}"
  - SNYK_MODE=WARN
  - secure: "KOEncoUStcCmiKviTz/u8KsiI5/+namjIZmkMsb2waYui1GyR+jeax0tmvKsKfDl8o3kxOFPbkHvXDpx8OlkAmB6QOWzciJjmWJsg0XDguafaQ3o0oZzPXekuJdIwm5m/fGRcdVHzdtDZawYMF+5uNegaiIUvIs9134njsuKMaK/WAOYLiMMMNWbjh0su8Zf57VBd++JrR8R33NTwp5WKrzhledGeSzMgir7xHb1N42/M/uw7PYOWGOigZaHMLBqCZ0q5w36hvUKTr+T6xqmiGCh5zCEARu7gHMLHpSvUuTGUUjX0clV/6R9pLdt43S5LVdX80pnw8viDgxxB3/zkQpYMp8osNYxFY7wpcUlRwoL4aLhKL5Zlc4cbn8EwQ+lZQGhGw6sAfV+p6pY5XxMREvReQEQxfu5aMXeq493ZFfzVvfZotkPvO9eFmsiyP67wQHDBE4XsVTWf2za84kmXhrB6MfxPSd2f10FM5TJgBcfJZ833lkJtEHHclYWdtVrUsVtDJf8tviCeAkQwkOvFJL8BGOVPyg7EUKpmKmGgeK0yyUDCUfjHFQNu7nk+NuxBU4W6j80TlT/lw7hw4j0tlMcWc5HbsI4P4jw0RQYrYrIRhPBgRmhS/c73+m9aORAfrduVsJ6HQyMfxV6rP6amPY++ZoF/8hTRYrKvqsCU1U="
  - secure: "jqEtRezDwuHfjl6Mlpbc3P39SZytCA65d/u7MmLu3oWmnfSUOhiwQ7+Oph9O+RCletNduxNCvX17QO9BBUkIf2kS2yccZINoHqF4HVsEeWlCJb3TkiC/IZB2kLyQzAI6lk9A5CAS9aB1c0UPkjeLt6aUptYD4harJHoQlbQlexFO7CfXEeKoZSzPkAxOL7/npjG73Bj2NXDuOOg2rRid9do6iW/kNsVnnbLjpju4HeizUPfcspGuifUhnBtYwTVZ5PMWXZqC4iuRYf5GcUrWVIs+A6hgHciZ/2/OjELxI7mY6CvOr3U1jJm83LIuKJbin9WiVsUqiJNbQHHz1VA3NcQx0Xzqas1UGjPIIH6oaE6aq4oSx5QLHEb+T8IXOqhjNzUAgaJCVp0bq1tdj51r14XA+9voPt0XmLRzoR3yKAFafuWVD6Qg9bg+2etAA5r5zqXAL/qOV6twejkUbAQmIsXznBtKPfqcqEcswhUurNEhjIrg0jT1VRX86yf6ty+6Eo9Rdv5xBqAiZdIyLiRfBnRqeuA0pwSXih5+j5LyqFp8Pp9QqeMnlE3Tg/RcdygxqyRK5VlMnAgkNJy98Mf+yaNWQrPUyCv9bZ1iNeb0TGBdCW1McyXuVKQfGZA3J2+s4tWX+b0I0bQ8I/mtttp5czqqh1TsLrQmvAGu8ec8oEs="
  - secure: "Xn3d4yNKBTzQlpvIaJkkH3Rzi+bqPS03ODhdwnf/ghCjsLTAJ5TO+VSxf9OH21f+Ih/t0xbzx67lBVUurWpTCK5zOD/bDxdZohsClZazPNAk9DDWa6rhxC8JA28zwTnI2cp2rsj+SEmqhq3LLIGx4tshdZY3v4HrUZ/qk8eWaod9ec7i8suWg128OyDhk3E0z/QWJZhU4LxUyjVjjrMmm8jRnia75/x7YLo4RtWYXvQz9hKNzvA6mLs6huggUUxvTDO9yMYUp115k627kZEYksr6+0kqmp7fdmRXeoIPmTfWwNxJIRRNtVZe/Ou3V3x5P5MoWJxu44+UsrFWAPc7q5/BqGHBQGfZcby9l9u1zHBfSNwJSBso7YDiOp2+bc6KxKzBCD7PJhg783Ta9WZt4SlpxkKtsdSBLZ7DGn0IEsEkcTFJxzTzLisFA4W4ZDic6BpqyAD2w9Y5TubmK3J/02rfkLvxa43qVwjmTVfeMyL86Yr1FXU21CP52ryHLLI+8v+lGDEhxuF2Jztu7wV5vOKDJnbJt2dELgf94fPJt8ID0mxpyYFsrkkNUdo0U/52v/WfcOB8rRqgFlm/T+Tz5/5mbZlJKHkMYNlMnPi52zLxiaI25w2YDs16QWyZ+DrU9g+qlT2FtgxkxFYHERPsKBwY7cPoONJZd7YImyaUCb4="
script:
- npm install -g snyk
- python setup.py test
- ./.travis/docker-build.sh
after_script:
- docker images
deploy:
  provider: script
  script: ./.travis/docker-push.sh
  on:
    tags: true
    branch: master